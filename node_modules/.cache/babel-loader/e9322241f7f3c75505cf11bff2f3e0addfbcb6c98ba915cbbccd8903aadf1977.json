{"ast":null,"code":"var _jsxFileName = \"D:\\\\langchain\\\\my-app\\\\src\\\\index.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport ReactDOM from 'react-dom';\nimport ReactDOMServer from 'react-dom/server';\nimport { mapValues } from 'lodash';\nimport { diffLines, formatLines } from 'unidiff';\nimport { parseDiff, Diff, Hunk, getChangeKey } from 'react-diff-view';\nimport { useConversations, Conversation } from './comments';\nimport 'react-diff-view/style/index.css';\nimport './style.css';\nimport { json } from 'body-parser';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst EMPTY_HUNKS = [];\nfunction App() {\n  _s();\n  const [oldCode, setOldCode] = useState('');\n  const [newCode, setNewCode] = useState('');\n  const [{\n    type,\n    hunks\n  }, setDiff] = useState({\n    type: '',\n    hunks: EMPTY_HUNKS\n  });\n  const fetchCodeFromAPI = useCallback(async () => {\n    try {\n      console.log(\"HELLO\");\n      const response = await fetch(\"http://localhost:3001/api/codes\");\n      if (!response.ok) {\n        console.log('Failed to fetch code from API');\n        throw new Error('Failed to fetch code from API');\n      }\n      console.log(\"Data Received\");\n      const {\n        oldCode,\n        newCode\n      } = await response.json();\n      console.log(oldCode.products[0]);\n      const oldcode1 = json.stringify(oldCode.products[0]['title']);\n      console.log(oldcode1);\n      setOldCode(oldcode1);\n      setNewCode(newCode);\n    } catch (error) {\n      console.error('Error fetching code:', error);\n    }\n  }, []);\n  useEffect(() => {\n    fetchCodeFromAPI();\n  }, [fetchCodeFromAPI]);\n  const generateDiff = useCallback(() => {\n    if (typeof oldCode !== 'string' || typeof newCode !== 'string') {\n      console.error('Old code or new code is not a string:', {\n        oldCode,\n        newCode\n      });\n      return;\n    }\n    if (oldCode && newCode) {\n      const diffText = formatLines(diffLines(oldCode, newCode), {\n        context: 3\n      });\n      const [diff] = parseDiff(diffText, {\n        nearbySequences: 'zip'\n      });\n      setDiff({\n        type: 'split',\n        hunks: diff.hunks || EMPTY_HUNKS\n      });\n    }\n  }, [oldCode, newCode]);\n  useEffect(() => {\n    generateDiff();\n  }, [oldCode, newCode, generateDiff]);\n  const [conversations, {\n    initConversation,\n    addComment\n  }] = useConversations();\n  const codeEvents = {\n    onDoubleClick({\n      change\n    }) {\n      const key = getChangeKey(change);\n      if (!conversations[key]) {\n        initConversation(key);\n      }\n    }\n  };\n  const widgets = mapValues(conversations, ({\n    comments\n  }, changeKey) => /*#__PURE__*/_jsxDEV(Conversation, {\n    changeKey: changeKey,\n    comments: comments,\n    onSubmitComment: addComment\n  }, changeKey, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 9\n  }, this));\n  const serializeContentToHTML = useCallback(() => {\n    const diffContent = /*#__PURE__*/_jsxDEV(Diff, {\n      viewType: \"split\",\n      diffType: type,\n      hunks: hunks || EMPTY_HUNKS,\n      children: hunks => hunks.map(hunk => /*#__PURE__*/_jsxDEV(Hunk, {\n        hunk: hunk,\n        codeEvents: codeEvents,\n        widgets: widgets\n      }, hunk.content, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }, this);\n    const htmlContent = ReactDOMServer.renderToStaticMarkup(diffContent);\n    const styles = `\n            body { font-family: Arial, sans-serif; width:100%}\n            .diff { display: flex; }\n            .hunk { margin: 10px 0; }\n            .insert { background-color: lightgreen; width:50%}\n            .delete { background-color: lightcoral; width:50%}\n        `;\n    const fullHtml = `\n            <!DOCTYPE html>\n            <html lang=\"en\">\n            <head>\n                <meta charset=\"UTF-8\">\n                <title>Generated Content</title>\n                <style>\n                    ${styles}\n                </style>\n                <link rel=\"stylesheet\" href=\"https://unpkg.com/react-diff-view/style/index.css\">\n                <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/antd/4.16.13/antd.min.css\">\n            </head>\n            <body>\n                ${htmlContent}\n            </body>\n            </html>\n        `;\n    console.log('Sending HTML content to server for saving:', fullHtml);\n    fetch('http://localhost:3001/save-html', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        html: fullHtml,\n        filename: 'generated_content.html'\n      })\n    }).then(response => {\n      if (!response.ok) {\n        throw new Error('Failed to save HTML content');\n      }\n      console.log('HTML content saved successfully');\n    }).catch(error => {\n      console.error('Error saving HTML:', error);\n    });\n  }, [type, hunks, codeEvents, widgets]);\n  useEffect(() => {\n    if (oldCode && newCode && hunks.length > 0) {\n      serializeContentToHTML();\n    }\n  }, [oldCode, newCode, hunks, serializeContentToHTML]);\n  return null; // No need to render anything on the webpage\n}\n_s(App, \"ZcaQskQxybk4jetF520aGa5kkM8=\", false, function () {\n  return [useConversations];\n});\n_c = App;\nconst rootElement = document.getElementById('root');\nReactDOM.render( /*#__PURE__*/_jsxDEV(App, {}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 142,\n  columnNumber: 17\n}, this), rootElement);\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","ReactDOM","ReactDOMServer","mapValues","diffLines","formatLines","parseDiff","Diff","Hunk","getChangeKey","useConversations","Conversation","json","jsxDEV","_jsxDEV","EMPTY_HUNKS","App","_s","oldCode","setOldCode","newCode","setNewCode","type","hunks","setDiff","fetchCodeFromAPI","console","log","response","fetch","ok","Error","products","oldcode1","stringify","error","generateDiff","diffText","context","diff","nearbySequences","conversations","initConversation","addComment","codeEvents","onDoubleClick","change","key","widgets","comments","changeKey","onSubmitComment","fileName","_jsxFileName","lineNumber","columnNumber","serializeContentToHTML","diffContent","viewType","diffType","children","map","hunk","content","htmlContent","renderToStaticMarkup","styles","fullHtml","method","headers","body","JSON","html","filename","then","catch","length","_c","rootElement","document","getElementById","render","$RefreshReg$"],"sources":["D:/langchain/my-app/src/index.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport ReactDOM from 'react-dom';\nimport ReactDOMServer from 'react-dom/server';\nimport { mapValues } from 'lodash';\nimport { diffLines, formatLines } from 'unidiff';\nimport { parseDiff, Diff, Hunk, getChangeKey } from 'react-diff-view';\nimport { useConversations, Conversation } from './comments';\nimport 'react-diff-view/style/index.css';\nimport './style.css';\nimport { json } from 'body-parser';\n\nconst EMPTY_HUNKS = [];\n\nfunction App() {\n    const [oldCode, setOldCode] = useState('');\n    const [newCode, setNewCode] = useState('');\n    const [{ type, hunks }, setDiff] = useState({ type: '', hunks: EMPTY_HUNKS });\n\n    const fetchCodeFromAPI = useCallback(async () => {\n        try {\n            console.log(\"HELLO\");\n            const response = await fetch(\"http://localhost:3001/api/codes\");\n\n            if (!response.ok) {\n                console.log('Failed to fetch code from API');\n                throw new Error('Failed to fetch code from API');\n            }\n            console.log(\"Data Received\");\n\n            const { oldCode, newCode } = await response.json();\n            console.log(oldCode.products[0]);\n            const oldcode1 = json.stringify(oldCode.products[0]['title'])\n            console.log(oldcode1);\n            setOldCode(oldcode1);\n            setNewCode(newCode);\n        } catch (error) {\n            console.error('Error fetching code:', error);\n        }\n    }, []);\n\n    useEffect(() => {\n        fetchCodeFromAPI();\n    }, [fetchCodeFromAPI]);\n\n    const generateDiff = useCallback(() => {\n        if (typeof oldCode !== 'string' || typeof newCode !== 'string') {\n            console.error('Old code or new code is not a string:', { oldCode, newCode });\n            return;\n        }\n        \n        if (oldCode && newCode) {\n            const diffText = formatLines(diffLines(oldCode, newCode), { context: 3 });\n            const [diff] = parseDiff(diffText, { nearbySequences: 'zip' });\n            setDiff({ type: 'split', hunks: diff.hunks || EMPTY_HUNKS });\n        }\n    }, [oldCode, newCode]);\n\n    useEffect(() => {\n        generateDiff();\n    }, [oldCode, newCode, generateDiff]);\n\n    const [conversations, { initConversation, addComment }] = useConversations();\n    const codeEvents = {\n        onDoubleClick({ change }) {\n            const key = getChangeKey(change);\n            if (!conversations[key]) {\n                initConversation(key);\n            }\n        },\n    };\n\n    const widgets = mapValues(conversations, ({ comments }, changeKey) => (\n        <Conversation key={changeKey} changeKey={changeKey} comments={comments} onSubmitComment={addComment} />\n    ));\n\n    const serializeContentToHTML = useCallback(() => {\n        const diffContent = (\n            <Diff viewType=\"split\" diffType={type} hunks={hunks || EMPTY_HUNKS}>\n                {hunks => hunks.map(hunk => (\n                    <Hunk key={hunk.content} hunk={hunk} codeEvents={codeEvents} widgets={widgets} />\n                ))}\n            </Diff>\n        );\n\n        const htmlContent = ReactDOMServer.renderToStaticMarkup(diffContent);\n\n        const styles = `\n            body { font-family: Arial, sans-serif; width:100%}\n            .diff { display: flex; }\n            .hunk { margin: 10px 0; }\n            .insert { background-color: lightgreen; width:50%}\n            .delete { background-color: lightcoral; width:50%}\n        `;\n\n        const fullHtml = `\n            <!DOCTYPE html>\n            <html lang=\"en\">\n            <head>\n                <meta charset=\"UTF-8\">\n                <title>Generated Content</title>\n                <style>\n                    ${styles}\n                </style>\n                <link rel=\"stylesheet\" href=\"https://unpkg.com/react-diff-view/style/index.css\">\n                <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/antd/4.16.13/antd.min.css\">\n            </head>\n            <body>\n                ${htmlContent}\n            </body>\n            </html>\n        `;\n\n        console.log('Sending HTML content to server for saving:', fullHtml);\n        fetch('http://localhost:3001/save-html', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({ html: fullHtml, filename: 'generated_content.html' }),\n        })\n        .then(response => {\n            if (!response.ok) {\n                throw new Error('Failed to save HTML content');\n            }\n            console.log('HTML content saved successfully');\n        })\n        .catch(error => {\n            console.error('Error saving HTML:', error);\n        });\n    }, [type, hunks, codeEvents, widgets]);\n\n    useEffect(() => {\n        if (oldCode && newCode && hunks.length > 0) {\n            serializeContentToHTML();\n        }\n    }, [oldCode, newCode, hunks, serializeContentToHTML]);\n\n    return null; // No need to render anything on the webpage\n}\n\nconst rootElement = document.getElementById('root');\nReactDOM.render(<App />, rootElement);\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}